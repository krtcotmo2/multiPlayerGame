<!DOCTYPE html>
<html>

<head>
     <meta charset="utf-8">
     <meta name="viewport" content="width=device-width, initial-scale=1">
     <title>Welcome to Firebase Hosting</title>
     <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
          crossorigin="anonymous">
     <link rel="stylesheet" href="./assets/css/style.css">
     <!-- update the version number as needed -->
     <script defer src="/__/firebase/5.7.2/firebase-app.js"></script>
     <!-- include only the Firebase features as you need -->
     <script defer src="/__/firebase/5.7.2/firebase-auth.js"></script>
     <script defer src="/__/firebase/5.7.2/firebase-database.js"></script>
     <script defer src="/__/firebase/5.7.2/firebase-messaging.js"></script>
     <script defer src="/__/firebase/5.7.2/firebase-storage.js"></script>
     <script defer src="/__/firebase/5.7.2/firebase-firestore.js"></script>
     <!-- initialize the SDK after all desired features are loaded -->
     <script defer src="/__/firebase/init.js"></script>
</head>

<body>
     <div id="login" class="container">
          <h2>World Championship Rock Paper Scissors Tournament</h2>
          <form class="needs-validation" role="form" data-toggle="validator" novalidate="true">
               <div id="newUserSection">
                    <div class="form-group">
                         <label for="tboxName">Name</label>
                         <input type="text" class="form-control" id="tboxName" placeholder="Enter Name" required="required">
                         <div class="help-block with-errors"></div>
                    </div>
                    <div class="form-group">
                         <label for="tboxUserName">User ID</label>
                         <input type="text" class="form-control" id="tboxUserName" placeholder="User name" required="required"
                              data-error="Please enter your user name.">
                    </div>
               </div>
               <div id="loginSection">
                    <div class="form-group">
                         <label for="tboxLogIn">Enter Your Login ID</label>
                         <input type="text" class="form-control" id="tboxLogin" placeholder="Login ID" required="required">
                    </div>
               </div>
               <button type="submit" id="btnAdd" class="btn btn-primary">Submit</button><br />
               <button type="button" id="btnCreateID" class="btn btn-link pl-0">Create login</button>
          </form>
          <div id="curPlayer">
               <h2></h2>
               <button role="button" class="">Logout</button>
          </div>
     </div>
     <div class="container col-12" id="mainGame">
          <div class="row">
               <div class="card col-3 px-0" id="players">
                    <div class="card-header">
                         Current Players
                    </div>
                    <div class="card-body">
                         
                    </div>
               </div>
               <div class="card col-6 px-0">
                    <div class="card-header">
                         Current Game
                    </div>
                    <div class="card-body">
                         Play options
                    </div>
               </div>

               <div class="card col-3 px-0">
                    <div class="card-header">
                         Leader Board
                    </div>
                    <div class="card-body">
                    </div>
               </div>
          </div>
     </div>
     <div class="modal" tabindex="-1" role="dialog" id="mainModal">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title">Modal title</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                <p>Modal body text goes here.</p>
              </div>
              <div class="modal-footer">
                <button type="button" id="btnTakeChallenge" class="btn btn-primary">Accept the Challenge</button>
                <button type="button" id="btnHideChallenge" class="btn btn-secondary">Hide like a Coward</button>
              </div>
            </div>
          </div>
        </div>

     <footer id="load">Firebase SDK Loading&hellip;</footer>
     <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js'></script>
     <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
     <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
     <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
     <script src="https://cdnjs.cloudflare.com/ajax/libs/1000hz-bootstrap-validator/0.11.9/validator.min.js"></script>
     <script src="./assets/script/fireStoreCalls.js"></script>
     <script src="./assets/script/basciCalls.js"></script>
     <script type="text/javascript" src="./assets/script/check_browser_close.js"></script>
     <script>
          $(document).ready(function () {
               try {
                    let app = firebase.app();
                    let features = ['auth', 'database', 'messaging', 'storage'].filter(feature => typeof app[feature] === 'function');
                    document.getElementById('load').innerHTML = `Firebase SDK loaded with ${features.join(', ')}`;
                    const firestore = firebase.firestore();
                    const settings = { timestampsInSnapshots: true };
                    firestore.settings(settings);                   
               } catch (e) {
                    console.error(e);
                    document.getElementById('load').innerHTML = 'Error loading the Firebase SDK, check the console.';
               }
               fs.syncPlayers();
               $("#btnCreateID").on("click", function () {
                    $("#loginSection").css("display", "none");
                    $(this).css("display", "none");
                    $("#newUserSection").css("display", "block");
               });
               $("#btnAdd").on("click", function (evt) {
                    evt.preventDefault();                    
                    if ($("#loginSection").css("display") == "none") {
                         //create user
                         fs.newUser($("#tboxName").val().trim(), $("#tboxUserName").val().trim().toLowerCase(), mainUser);
                    } else {
                         //load user
                         fs.getUserId($("#tboxLogin").val().trim().toLowerCase(), mainUser);
                    }
               })
               $("#curPlayer button").on("click", function(){
                    fs.logOut(mainUser.userName, mainUser);
               });
               $("#btnTakeChallenge").on("click", );
               $("#btnHideChallenge").on("click", function(){
                    fs.rejectChallenge();
               });
               $(document).on("click", ".aPlayer", function(evt){
                    fs.issueChallenge(mainUser, $(this).data("user"));
               })
          });
     </script>
</body>

</html>